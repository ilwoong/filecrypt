# FileCrypt

FileCrypt는 입력받은 패스워드로부터 키와 IV를 유도하여 AES256-GCM 모드로 파일을 암/복호화합니다.


## 사용방법

```bash
[Usage] filecrypt [enc/dec] pass_phrase src_file_path dst_file_path
```


## 키 유도 과정

HMAC-SHA256을 사용하는 PBKDF2 알고리즘을 사용하여 48바이트(384비트)의 값을 유도하고, 상위 32바이트는 키로, 하위 16바이트는 IV로 사용합니다. 이 때 필요한 SALT는 난수발생 알고리즘을 사용하여 32바이트의 난수를 생성하여 사용합니다. 사용한 난수발생기는 C++11부터 기본으로 제공하는 메르센 트위스터 난수발생 알고리즘입니다.


## 암호화된 파일 구조

다음과 같은 구조로 파일을 암호화하여 저장합니다.

SALT(32B) || IV(16B) || ENCRYPTED_DATA(평문 파일 크기) || TAG(16B)


## 복호화 과정

암호화된 파일의 첫 부분에서 SALT와 IV를 추출하고, 입력받은 패스워드를 PBKDF2 알고리즘을 사용하여 키와 IV를 계산합니다.
이 때, 계산한 IV와 파일에서 추출한 IV의 값이 다르면 잘못된 패스워드 입력으로 판단하여 복호화를 수행하지 않고 종료합니다.
계산한 키와 IV를 이용하여 AES256-GCM 모드로 파일을 복호화한 후, TAG 일치여부를 확인하여, TAG가 일치한 경우에만 복호화된 파일을 생성합니다.


## 빌드 환경

이 프로젝트를 빌드하기 위해서는 C++11 표준을 지원하는 C++ 컴파일러와 OpenSSL 라이브러리가 필요합니다. 우분투의 경우 libssl-dev 패키지를 설치하여 사용할 수 있습니다.

